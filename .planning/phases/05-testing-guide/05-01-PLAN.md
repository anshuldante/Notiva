---
phase: 05-testing-guide
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/TESTING.md
  - docs/README.md
autonomous: true

must_haves:
  truths:
    - "Developer can find testing documentation from README"
    - "Developer understands test directory structure (unit vs instrumented)"
    - "Developer can run unit tests with documented command"
    - "Developer can run instrumented tests with documented command"
    - "Developer can write a new unit test following documented patterns"
    - "Developer can write a new instrumented test following documented patterns"
  artifacts:
    - path: "docs/TESTING.md"
      provides: "Testing guide with structure, commands, and patterns"
      min_lines: 150
      contains:
        - "Unit Tests"
        - "Instrumented Tests"
        - "./gradlew test"
        - "./gradlew connectedAndroidTest"
        - "@Test"
        - "@RunWith(AndroidJUnit4.class)"
    - path: "docs/README.md"
      provides: "Updated documentation hub with TESTING.md link"
      contains:
        - "[TESTING.md](TESTING.md)"
        - "Available"
  key_links:
    - from: "docs/README.md"
      to: "docs/TESTING.md"
      via: "Navigation table link"
      pattern: "\\[TESTING.md\\]\\(TESTING.md\\)"
    - from: "docs/TESTING.md"
      to: "docs/ARCHITECTURE.md"
      via: "Cross-reference to architecture"
      pattern: "\\[ARCHITECTURE\\.md\\]"
---

<objective>
Create comprehensive testing documentation for Notiva that enables developers to run existing tests and write new ones.

Purpose: Fulfill REF-03 requirement - developers need to understand the testing approach, run tests, and contribute new tests following established patterns.

Output:
- docs/TESTING.md - Complete testing guide with directory structure, run commands, frameworks, and example patterns
- Updated docs/README.md - Mark TESTING.md as Available in documentation status
</objective>

<execution_context>
@/Users/ansagagr/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ansagagr/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/TESTING.md
@docs/README.md
@docs/ARCHITECTURE.md
@app/build.gradle
@app/src/androidTest/java/com/ava/notiva/ExampleInstrumentedTest.java
@app/src/androidTest/java/com/ava/notiva/ExampleUnitTest.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TESTING.md documentation</name>
  <files>docs/TESTING.md</files>
  <action>
Create docs/TESTING.md with comprehensive testing documentation following the style established in ARCHITECTURE.md and DATABASE.md.

IMPORTANT: This is a Java Android app, NOT Kotlin. All examples must use Java syntax.

Structure the document with these sections:

1. **Overview header** - Brief intro, link back to README and ARCHITECTURE

2. **Testing Philosophy** - Brief section on testing approach (JUnit 4, minimal current coverage, placeholder for expansion)

3. **Test Directory Structure** - Document the actual structure:
   - `app/src/test/java/` - Local unit tests (JVM-only, no Android framework)
   - `app/src/androidTest/java/` - Instrumented tests (run on device/emulator)
   - Note: Currently ExampleUnitTest.java is misplaced in androidTest (should be in test)
   - Package structure mirrors main source: `com/ava/notiva/`

4. **Test Frameworks and Dependencies** - Document from app/build.gradle:
   - JUnit 4.13.2 - Unit testing framework
   - AndroidX Test JUnit 1.3.0 - Android test support
   - Espresso 3.7.0 - UI/Instrumentation testing (available but not currently used)
   - Test runner: `androidx.test.runner.AndroidJUnitRunner`

5. **Running Tests** - Document commands:
   - Unit tests: `./gradlew test` or `./gradlew testDebugUnitTest`
   - Instrumented tests: `./gradlew connectedAndroidTest` or from Android Studio
   - Single class: `./gradlew test --tests "com.ava.notiva.ExampleUnitTest"`
   - Include Android Studio UI method (Run > Test in package)

6. **Existing Test Examples** - Show actual code from the codebase:
   - ExampleUnitTest.java - Basic JUnit test pattern (no Android dependencies)
   - ExampleInstrumentedTest.java - AndroidJUnit4 pattern with InstrumentationRegistry
   - Explain annotations: @Test, @RunWith, @Before, @After

7. **Writing New Tests** - Provide templates:
   - Unit test template for testing pure Java classes (e.g., testing RecurrenceType logic)
   - Instrumented test template for testing with Android context
   - Room database test template pattern (in-memory database testing)
   - Include naming conventions: {ClassName}Test.java, test{MethodName}_{scenario}_{expectedResult}

8. **Test Coverage Priorities** - Document what needs testing (from codebase analysis):
   - High priority: ReminderModel.getNextOccurrenceAfter() - complex recurrence logic
   - High priority: ReminderRepository async operations
   - Medium priority: DbTypeConverters edge cases
   - Reference: Future expansion could add Mockito for mocking, LiveData testing utilities

9. **Common Testing Patterns** - Show patterns relevant to this codebase:
   - Testing with JUnit assertions (assertEquals, assertTrue, assertNotNull)
   - Context access in instrumented tests via InstrumentationRegistry
   - Async testing with CountDownLatch pattern (conceptual, not currently implemented)

10. **Troubleshooting** section:
    - "No tests found" - check package structure matches
    - Instrumented test requires connected device/emulator
    - Hilt test issues - may need @HiltAndroidTest annotation

11. **Next Steps** - Links to related docs (ARCHITECTURE.md, CONTRIBUTING.md when available)

Use consistent formatting:
- Tables for frameworks/dependencies
- Code blocks with java syntax highlighting
- Mermaid diagram showing test types relationship (optional)
- Match heading style from ARCHITECTURE.md
  </action>
  <verify>
- File exists at docs/TESTING.md
- Contains sections: Overview, Directory Structure, Running Tests, Writing New Tests
- All code examples use Java syntax (not Kotlin)
- Commands documented: ./gradlew test, ./gradlew connectedAndroidTest
- Examples reference actual test files in codebase
  </verify>
  <done>
- docs/TESTING.md exists with 150+ lines
- Document covers unit tests and instrumented tests
- Run commands are clearly documented
- Example patterns show actual Java code from codebase
- Developer can follow guide to run existing tests and write new ones
  </done>
</task>

<task type="auto">
  <name>Task 2: Update README.md documentation status</name>
  <files>docs/README.md</files>
  <action>
Update docs/README.md to reflect that TESTING.md is now available:

1. In the "Documentation Status" table, change TESTING.md row:
   - From: `| [TESTING.md](TESTING.md) | Planned | Testing strategy and guides |`
   - To: `| [TESTING.md](TESTING.md) | Available | Testing strategy and guides |`

2. Verify the Navigation table already has the correct link:
   - `| Run or write tests | [Testing Guide](TESTING.md) |`

3. Update the documentation last updated date at the bottom of the file.

No other changes needed - the navigation link already exists from Phase 1.
  </action>
  <verify>
- docs/README.md contains "TESTING.md" with "Available" status
- Navigation table link to TESTING.md is present
- Last updated date is current
  </verify>
  <done>
- README.md Documentation Status shows TESTING.md as Available
- Navigation table correctly links to Testing Guide
- Documentation hub accurately reflects current state
  </done>
</task>

</tasks>

<verification>
After completing both tasks:

1. Verify TESTING.md content:
   ```bash
   # Check file exists and has content
   wc -l docs/TESTING.md
   # Should show 150+ lines

   # Verify key sections exist
   grep -c "Unit Test" docs/TESTING.md
   grep -c "Instrumented Test" docs/TESTING.md
   grep -c "./gradlew" docs/TESTING.md
   grep -c "@Test" docs/TESTING.md
   ```

2. Verify README.md update:
   ```bash
   # Check TESTING.md is marked Available
   grep "TESTING.md.*Available" docs/README.md
   ```

3. Verify links work:
   ```bash
   # Ensure the linked file exists
   test -f docs/TESTING.md && echo "TESTING.md exists"
   ```

4. Test consistency:
   - Open docs/TESTING.md in browser/viewer
   - Verify Mermaid diagrams render (if included)
   - Verify code blocks have proper syntax highlighting
</verification>

<success_criteria>
Phase 5 is complete when:

1. **docs/TESTING.md exists** with comprehensive testing documentation
2. **Commands documented** - Developer can run `./gradlew test` and `./gradlew connectedAndroidTest`
3. **Directory structure explained** - Unit tests vs instrumented tests locations clear
4. **Example patterns** - Java code examples show how to write both test types
5. **README updated** - TESTING.md marked as Available in documentation status
6. **Developer can act** - A new developer reading the guide can:
   - Run existing unit tests
   - Run existing instrumented tests
   - Write a new unit test following the documented pattern
   - Write a new instrumented test following the documented pattern
</success_criteria>

<output>
After completion, create `.planning/phases/05-testing-guide/05-01-SUMMARY.md` following the summary template with:
- What was created (TESTING.md)
- What was updated (README.md status)
- Key patterns documented (JUnit 4, AndroidJUnit4)
- Commands documented (gradlew test, connectedAndroidTest)
- Decisions made during implementation
</output>
